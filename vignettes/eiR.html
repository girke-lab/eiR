<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="author" content="Authors: Kevin Horan, Yiqun Cao, Tyler Backman &amp; Thomas Girke" />


<title>eiR: Accelerated Similarity Searching of Small Molecules</title>


<style type="text/css">code{white-space: pre;}</style>
<link href="data:text/css;charset=utf-8,pre%20%2Eoperator%2C%0Apre%20%2Eparen%20%7B%0Acolor%3A%20rgb%28104%2C%20118%2C%20135%29%0A%7D%0Apre%20%2Eliteral%20%7B%0Acolor%3A%20%23990073%0A%7D%0Apre%20%2Enumber%20%7B%0Acolor%3A%20%23099%3B%0A%7D%0Apre%20%2Ecomment%20%7B%0Acolor%3A%20%23998%3B%0Afont%2Dstyle%3A%20italic%0A%7D%0Apre%20%2Ekeyword%20%7B%0Acolor%3A%20%23900%3B%0Afont%2Dweight%3A%20bold%0A%7D%0Apre%20%2Eidentifier%20%7B%0Acolor%3A%20rgb%280%2C%200%2C%200%29%3B%0A%7D%0Apre%20%2Estring%20%7B%0Acolor%3A%20%23d14%3B%0A%7D%0A" rel="stylesheet" type="text/css" />
<script src="data:application/x-javascript;base64,CnZhciBobGpzPW5ldyBmdW5jdGlvbigpe2Z1bmN0aW9uIG0ocCl7cmV0dXJuIHAucmVwbGFjZSgvJi9nbSwiJmFtcDsiKS5yZXBsYWNlKC88L2dtLCImbHQ7Iil9ZnVuY3Rpb24gZihyLHEscCl7cmV0dXJuIFJlZ0V4cChxLCJtIisoci5jST8iaSI6IiIpKyhwPyJnIjoiIikpfWZ1bmN0aW9uIGIocil7Zm9yKHZhciBwPTA7cDxyLmNoaWxkTm9kZXMubGVuZ3RoO3ArKyl7dmFyIHE9ci5jaGlsZE5vZGVzW3BdO2lmKHEubm9kZU5hbWU9PSJDT0RFIil7cmV0dXJuIHF9aWYoIShxLm5vZGVUeXBlPT0zJiZxLm5vZGVWYWx1ZS5tYXRjaCgvXHMrLykpKXticmVha319fWZ1bmN0aW9uIGgodCxzKXt2YXIgcD0iIjtmb3IodmFyIHI9MDtyPHQuY2hpbGROb2Rlcy5sZW5ndGg7cisrKXtpZih0LmNoaWxkTm9kZXNbcl0ubm9kZVR5cGU9PTMpe3ZhciBxPXQuY2hpbGROb2Rlc1tyXS5ub2RlVmFsdWU7aWYocyl7cT1xLnJlcGxhY2UoL1xuL2csIiIpfXArPXF9ZWxzZXtpZih0LmNoaWxkTm9kZXNbcl0ubm9kZU5hbWU9PSJCUiIpe3ArPSJcbiJ9ZWxzZXtwKz1oKHQuY2hpbGROb2Rlc1tyXSl9fX1pZigvTVNJRSBbNjc4XS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7cD1wLnJlcGxhY2UoL1xyL2csIlxuIil9cmV0dXJuIHB9ZnVuY3Rpb24gYShzKXt2YXIgcj1zLmNsYXNzTmFtZS5zcGxpdCgvXHMrLyk7cj1yLmNvbmNhdChzLnBhcmVudE5vZGUuY2xhc3NOYW1lLnNwbGl0KC9ccysvKSk7Zm9yKHZhciBxPTA7cTxyLmxlbmd0aDtxKyspe3ZhciBwPXJbcV0ucmVwbGFjZSgvXmxhbmd1YWdlLS8sIiIpO2lmKGVbcF0pe3JldHVybiBwfX19ZnVuY3Rpb24gYyhxKXt2YXIgcD1bXTsoZnVuY3Rpb24ocyx0KXtmb3IodmFyIHI9MDtyPHMuY2hpbGROb2Rlcy5sZW5ndGg7cisrKXtpZihzLmNoaWxkTm9kZXNbcl0ubm9kZVR5cGU9PTMpe3QrPXMuY2hpbGROb2Rlc1tyXS5ub2RlVmFsdWUubGVuZ3RofWVsc2V7aWYocy5jaGlsZE5vZGVzW3JdLm5vZGVOYW1lPT0iQlIiKXt0Kz0xfWVsc2V7aWYocy5jaGlsZE5vZGVzW3JdLm5vZGVUeXBlPT0xKXtwLnB1c2goe2V2ZW50OiJzdGFydCIsb2Zmc2V0OnQsbm9kZTpzLmNoaWxkTm9kZXNbcl19KTt0PWFyZ3VtZW50cy5jYWxsZWUocy5jaGlsZE5vZGVzW3JdLHQpO3AucHVzaCh7ZXZlbnQ6InN0b3AiLG9mZnNldDp0LG5vZGU6cy5jaGlsZE5vZGVzW3JdfSl9fX19cmV0dXJuIHR9KShxLDApO3JldHVybiBwfWZ1bmN0aW9uIGsoeSx3LHgpe3ZhciBxPTA7dmFyIHo9IiI7dmFyIHM9W107ZnVuY3Rpb24gdSgpe2lmKHkubGVuZ3RoJiZ3Lmxlbmd0aCl7aWYoeVswXS5vZmZzZXQhPXdbMF0ub2Zmc2V0KXtyZXR1cm4oeVswXS5vZmZzZXQ8d1swXS5vZmZzZXQpP3k6d31lbHNle3JldHVybiB3WzBdLmV2ZW50PT0ic3RhcnQiP3k6d319ZWxzZXtyZXR1cm4geS5sZW5ndGg/eTp3fX1mdW5jdGlvbiB0KEQpe3ZhciBBPSI8IitELm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7Zm9yKHZhciBCPTA7QjxELmF0dHJpYnV0ZXMubGVuZ3RoO0IrKyl7dmFyIEM9RC5hdHRyaWJ1dGVzW0JdO0ErPSIgIitDLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7aWYoQy52YWx1ZSE9PXVuZGVmaW5lZCYmQy52YWx1ZSE9PWZhbHNlJiZDLnZhbHVlIT09bnVsbCl7QSs9Jz0iJyttKEMudmFsdWUpKyciJ319cmV0dXJuIEErIj4ifXdoaWxlKHkubGVuZ3RofHx3Lmxlbmd0aCl7dmFyIHY9dSgpLnNwbGljZSgwLDEpWzBdO3orPW0oeC5zdWJzdHIocSx2Lm9mZnNldC1xKSk7cT12Lm9mZnNldDtpZih2LmV2ZW50PT0ic3RhcnQiKXt6Kz10KHYubm9kZSk7cy5wdXNoKHYubm9kZSl9ZWxzZXtpZih2LmV2ZW50PT0ic3RvcCIpe3ZhciBwLHI9cy5sZW5ndGg7ZG97ci0tO3A9c1tyXTt6Kz0oIjwvIitwLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkrIj4iKX13aGlsZShwIT12Lm5vZGUpO3Muc3BsaWNlKHIsMSk7d2hpbGUocjxzLmxlbmd0aCl7eis9dChzW3JdKTtyKyt9fX19cmV0dXJuIHorbSh4LnN1YnN0cihxKSl9ZnVuY3Rpb24gaigpe2Z1bmN0aW9uIHEoeCx5LHYpe2lmKHguY29tcGlsZWQpe3JldHVybn12YXIgdTt2YXIgcz1bXTtpZih4Lmspe3gubFI9Zih5LHgubHx8aGxqcy5JUix0cnVlKTtmb3IodmFyIHcgaW4geC5rKXtpZigheC5rLmhhc093blByb3BlcnR5KHcpKXtjb250aW51ZX1pZih4Lmtbd10gaW5zdGFuY2VvZiBPYmplY3Qpe3U9eC5rW3ddfWVsc2V7dT14Lms7dz0ia2V5d29yZCJ9Zm9yKHZhciByIGluIHUpe2lmKCF1Lmhhc093blByb3BlcnR5KHIpKXtjb250aW51ZX14Lmtbcl09W3csdVtyXV07cy5wdXNoKHIpfX19aWYoIXYpe2lmKHguYldLKXt4LmI9IlxcYigiK3Muam9pbigifCIpKyIpXFxzIn14LmJSPWYoeSx4LmI/eC5iOiJcXEJ8XFxiIik7aWYoIXguZSYmIXguZVcpe3guZT0iXFxCfFxcYiJ9aWYoeC5lKXt4LmVSPWYoeSx4LmUpfX1pZih4Lmkpe3guaVI9Zih5LHguaSl9aWYoeC5yPT09dW5kZWZpbmVkKXt4LnI9MX1pZigheC5jKXt4LmM9W119eC5jb21waWxlZD10cnVlO2Zvcih2YXIgdD0wO3Q8eC5jLmxlbmd0aDt0Kyspe2lmKHguY1t0XT09InNlbGYiKXt4LmNbdF09eH1xKHguY1t0XSx5LGZhbHNlKX1pZih4LnN0YXJ0cyl7cSh4LnN0YXJ0cyx5LGZhbHNlKX19Zm9yKHZhciBwIGluIGUpe2lmKCFlLmhhc093blByb3BlcnR5KHApKXtjb250aW51ZX1xKGVbcF0uZE0sZVtwXSx0cnVlKX19ZnVuY3Rpb24gZChCLEMpe2lmKCFqLmNhbGxlZCl7aigpO2ouY2FsbGVkPXRydWV9ZnVuY3Rpb24gcShyLE0pe2Zvcih2YXIgTD0wO0w8TS5jLmxlbmd0aDtMKyspe2lmKChNLmNbTF0uYlIuZXhlYyhyKXx8W251bGxdKVswXT09cil7cmV0dXJuIE0uY1tMXX19fWZ1bmN0aW9uIHYoTCxyKXtpZihEW0xdLmUmJkRbTF0uZVIudGVzdChyKSl7cmV0dXJuIDF9aWYoRFtMXS5lVyl7dmFyIE09dihMLTEscik7cmV0dXJuIE0/TSsxOjB9cmV0dXJuIDB9ZnVuY3Rpb24gdyhyLEwpe3JldHVybiBMLmkmJkwuaVIudGVzdChyKX1mdW5jdGlvbiBLKE4sTyl7dmFyIE09W107Zm9yKHZhciBMPTA7TDxOLmMubGVuZ3RoO0wrKyl7TS5wdXNoKE4uY1tMXS5iKX12YXIgcj1ELmxlbmd0aC0xO2Rve2lmKERbcl0uZSl7TS5wdXNoKERbcl0uZSl9ci0tfXdoaWxlKERbcisxXS5lVyk7aWYoTi5pKXtNLnB1c2goTi5pKX1yZXR1cm4gZihPLE0uam9pbigifCIpLHRydWUpfWZ1bmN0aW9uIHAoTSxMKXt2YXIgTj1EW0QubGVuZ3RoLTFdO2lmKCFOLnQpe04udD1LKE4sRSl9Ti50Lmxhc3RJbmRleD1MO3ZhciByPU4udC5leGVjKE0pO3JldHVybiByP1tNLnN1YnN0cihMLHIuaW5kZXgtTCksclswXSxmYWxzZV06W00uc3Vic3RyKEwpLCIiLHRydWVdfWZ1bmN0aW9uIHooTixyKXt2YXIgTD1FLmNJP3JbMF0udG9Mb3dlckNhc2UoKTpyWzBdO3ZhciBNPU4ua1tMXTtpZihNJiZNIGluc3RhbmNlb2YgQXJyYXkpe3JldHVybiBNfXJldHVybiBmYWxzZX1mdW5jdGlvbiBGKEwsUCl7TD1tKEwpO2lmKCFQLmspe3JldHVybiBMfXZhciByPSIiO3ZhciBPPTA7UC5sUi5sYXN0SW5kZXg9MDt2YXIgTT1QLmxSLmV4ZWMoTCk7d2hpbGUoTSl7cis9TC5zdWJzdHIoTyxNLmluZGV4LU8pO3ZhciBOPXooUCxNKTtpZihOKXt4Kz1OWzFdO3IrPSc8c3BhbiBjbGFzcz0iJytOWzBdKyciPicrTVswXSsiPC9zcGFuPiJ9ZWxzZXtyKz1NWzBdfU89UC5sUi5sYXN0SW5kZXg7TT1QLmxSLmV4ZWMoTCl9cmV0dXJuIHIrTC5zdWJzdHIoTyxMLmxlbmd0aC1PKX1mdW5jdGlvbiBKKEwsTSl7aWYoTS5zTCYmZVtNLnNMXSl7dmFyIHI9ZChNLnNMLEwpO3grPXIua2V5d29yZF9jb3VudDtyZXR1cm4gci52YWx1ZX1lbHNle3JldHVybiBGKEwsTSl9fWZ1bmN0aW9uIEkoTSxyKXt2YXIgTD1NLmNOPyc8c3BhbiBjbGFzcz0iJytNLmNOKyciPic6IiI7aWYoTS5yQil7eSs9TDtNLmJ1ZmZlcj0iIn1lbHNle2lmKE0uZUIpe3krPW0ocikrTDtNLmJ1ZmZlcj0iIn1lbHNle3krPUw7TS5idWZmZXI9cn19RC5wdXNoKE0pO0ErPU0ucn1mdW5jdGlvbiBHKE4sTSxRKXt2YXIgUj1EW0QubGVuZ3RoLTFdO2lmKFEpe3krPUooUi5idWZmZXIrTixSKTtyZXR1cm4gZmFsc2V9dmFyIFA9cShNLFIpO2lmKFApe3krPUooUi5idWZmZXIrTixSKTtJKFAsTSk7cmV0dXJuIFAuckJ9dmFyIEw9dihELmxlbmd0aC0xLE0pO2lmKEwpe3ZhciBPPVIuY04/Ijwvc3Bhbj4iOiIiO2lmKFIuckUpe3krPUooUi5idWZmZXIrTixSKStPfWVsc2V7aWYoUi5lRSl7eSs9SihSLmJ1ZmZlcitOLFIpK08rbShNKX1lbHNle3krPUooUi5idWZmZXIrTitNLFIpK099fXdoaWxlKEw+MSl7Tz1EW0QubGVuZ3RoLTJdLmNOPyI8L3NwYW4+IjoiIjt5Kz1PO0wtLTtELmxlbmd0aC0tfXZhciByPURbRC5sZW5ndGgtMV07RC5sZW5ndGgtLTtEW0QubGVuZ3RoLTFdLmJ1ZmZlcj0iIjtpZihyLnN0YXJ0cyl7SShyLnN0YXJ0cywiIil9cmV0dXJuIFIuckV9aWYodyhNLFIpKXt0aHJvdyJJbGxlZ2FsIn19dmFyIEU9ZVtCXTt2YXIgRD1bRS5kTV07dmFyIEE9MDt2YXIgeD0wO3ZhciB5PSIiO3RyeXt2YXIgcyx1PTA7RS5kTS5idWZmZXI9IiI7ZG97cz1wKEMsdSk7dmFyIHQ9RyhzWzBdLHNbMV0sc1syXSk7dSs9c1swXS5sZW5ndGg7aWYoIXQpe3UrPXNbMV0ubGVuZ3RofX13aGlsZSghc1syXSk7aWYoRC5sZW5ndGg+MSl7dGhyb3ciSWxsZWdhbCJ9cmV0dXJue3I6QSxrZXl3b3JkX2NvdW50OngsdmFsdWU6eX19Y2F0Y2goSCl7aWYoSD09IklsbGVnYWwiKXtyZXR1cm57cjowLGtleXdvcmRfY291bnQ6MCx2YWx1ZTptKEMpfX1lbHNle3Rocm93IEh9fX1mdW5jdGlvbiBnKHQpe3ZhciBwPXtrZXl3b3JkX2NvdW50OjAscjowLHZhbHVlOm0odCl9O3ZhciByPXA7Zm9yKHZhciBxIGluIGUpe2lmKCFlLmhhc093blByb3BlcnR5KHEpKXtjb250aW51ZX12YXIgcz1kKHEsdCk7cy5sYW5ndWFnZT1xO2lmKHMua2V5d29yZF9jb3VudCtzLnI+ci5rZXl3b3JkX2NvdW50K3Iucil7cj1zfWlmKHMua2V5d29yZF9jb3VudCtzLnI+cC5rZXl3b3JkX2NvdW50K3Aucil7cj1wO3A9c319aWYoci5sYW5ndWFnZSl7cC5zZWNvbmRfYmVzdD1yfXJldHVybiBwfWZ1bmN0aW9uIGkocixxLHApe2lmKHEpe3I9ci5yZXBsYWNlKC9eKCg8W14+XSs+fFx0KSspL2dtLGZ1bmN0aW9uKHQsdyx2LHUpe3JldHVybiB3LnJlcGxhY2UoL1x0L2cscSl9KX1pZihwKXtyPXIucmVwbGFjZSgvXG4vZywiPGJyPiIpfXJldHVybiByfWZ1bmN0aW9uIG4odCx3LHIpe3ZhciB4PWgodCxyKTt2YXIgdj1hKHQpO3ZhciB5LHM7aWYodil7eT1kKHYseCl9ZWxzZXtyZXR1cm59dmFyIHE9Yyh0KTtpZihxLmxlbmd0aCl7cz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJwcmUiKTtzLmlubmVySFRNTD15LnZhbHVlO3kudmFsdWU9ayhxLGMocykseCl9eS52YWx1ZT1pKHkudmFsdWUsdyxyKTt2YXIgdT10LmNsYXNzTmFtZTtpZighdS5tYXRjaCgiKFxcc3xeKShsYW5ndWFnZS0pPyIrdisiKFxcc3wkKSIpKXt1PXU/KHUrIiAiK3YpOnZ9aWYoL01TSUUgWzY3OF0vLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkmJnQudGFnTmFtZT09IkNPREUiJiZ0LnBhcmVudE5vZGUudGFnTmFtZT09IlBSRSIpe3M9dC5wYXJlbnROb2RlO3ZhciBwPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpO3AuaW5uZXJIVE1MPSI8cHJlPjxjb2RlPiIreS52YWx1ZSsiPC9jb2RlPjwvcHJlPiI7dD1wLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZDtwLmZpcnN0Q2hpbGQuY049cy5jTjtzLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKHAuZmlyc3RDaGlsZCxzKX1lbHNle3QuaW5uZXJIVE1MPXkudmFsdWV9dC5jbGFzc05hbWU9dTt0LnJlc3VsdD17bGFuZ3VhZ2U6dixrdzp5LmtleXdvcmRfY291bnQscmU6eS5yfTtpZih5LnNlY29uZF9iZXN0KXt0LnNlY29uZF9iZXN0PXtsYW5ndWFnZTp5LnNlY29uZF9iZXN0Lmxhbmd1YWdlLGt3Onkuc2Vjb25kX2Jlc3Qua2V5d29yZF9jb3VudCxyZTp5LnNlY29uZF9iZXN0LnJ9fX1mdW5jdGlvbiBvKCl7aWYoby5jYWxsZWQpe3JldHVybn1vLmNhbGxlZD10cnVlO3ZhciByPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwcmUiKTtmb3IodmFyIHA9MDtwPHIubGVuZ3RoO3ArKyl7dmFyIHE9YihyW3BdKTtpZihxKXtuKHEsaGxqcy50YWJSZXBsYWNlKX19fWZ1bmN0aW9uIGwoKXtpZih3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcil7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLG8sZmFsc2UpO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIixvLGZhbHNlKX1lbHNle2lmKHdpbmRvdy5hdHRhY2hFdmVudCl7d2luZG93LmF0dGFjaEV2ZW50KCJvbmxvYWQiLG8pfWVsc2V7d2luZG93Lm9ubG9hZD1vfX19dmFyIGU9e307dGhpcy5MQU5HVUFHRVM9ZTt0aGlzLmhpZ2hsaWdodD1kO3RoaXMuaGlnaGxpZ2h0QXV0bz1nO3RoaXMuZml4TWFya3VwPWk7dGhpcy5oaWdobGlnaHRCbG9jaz1uO3RoaXMuaW5pdEhpZ2hsaWdodGluZz1vO3RoaXMuaW5pdEhpZ2hsaWdodGluZ09uTG9hZD1sO3RoaXMuSVI9IlthLXpBLVpdW2EtekEtWjAtOV9dKiI7dGhpcy5VSVI9IlthLXpBLVpfXVthLXpBLVowLTlfXSoiO3RoaXMuTlI9IlxcYlxcZCsoXFwuXFxkKyk/Ijt0aGlzLkNOUj0iXFxiKDBbeFhdW2EtZkEtRjAtOV0rfChcXGQrKFxcLlxcZCopP3xcXC5cXGQrKShbZUVdWy0rXT9cXGQrKT8pIjt0aGlzLkJOUj0iXFxiKDBiWzAxXSspIjt0aGlzLlJTUj0iIXwhPXwhPT18JXwlPXwmfCYmfCY9fFxcKnxcXCo9fFxcK3xcXCs9fCx8XFwufC18LT18L3wvPXw6fDt8PHw8PHw8PD18PD18PXw9PXw9PT18Pnw+PXw+Pnw+Pj18Pj4+fD4+Pj18XFw/fFxcW3xcXHt8XFwofFxcXnxcXF49fFxcfHxcXHw9fFxcfFxcfHx+Ijt0aGlzLkVSPSIoPyFbXFxzXFxTXSkiO3RoaXMuQkU9e2I6IlxcXFwuIixyOjB9O3RoaXMuQVNNPXtjTjoic3RyaW5nIixiOiInIixlOiInIixpOiJcXG4iLGM6W3RoaXMuQkVdLHI6MH07dGhpcy5RU009e2NOOiJzdHJpbmciLGI6JyInLGU6JyInLGk6IlxcbiIsYzpbdGhpcy5CRV0scjowfTt0aGlzLkNMQ009e2NOOiJjb21tZW50IixiOiIvLyIsZToiJCJ9O3RoaXMuQ0JMQ0xNPXtjTjoiY29tbWVudCIsYjoiL1xcKiIsZToiXFwqLyJ9O3RoaXMuSENNPXtjTjoiY29tbWVudCIsYjoiIyIsZToiJCJ9O3RoaXMuTk09e2NOOiJudW1iZXIiLGI6dGhpcy5OUixyOjB9O3RoaXMuQ05NPXtjTjoibnVtYmVyIixiOnRoaXMuQ05SLHI6MH07dGhpcy5CTk09e2NOOiJudW1iZXIiLGI6dGhpcy5CTlIscjowfTt0aGlzLmluaGVyaXQ9ZnVuY3Rpb24ocixzKXt2YXIgcD17fTtmb3IodmFyIHEgaW4gcil7cFtxXT1yW3FdfWlmKHMpe2Zvcih2YXIgcSBpbiBzKXtwW3FdPXNbcV19fXJldHVybiBwfX0oKTtobGpzLkxBTkdVQUdFUy5jcHA9ZnVuY3Rpb24oKXt2YXIgYT17a2V5d29yZDp7ImZhbHNlIjoxLCJpbnQiOjEsImZsb2F0IjoxLCJ3aGlsZSI6MSwicHJpdmF0ZSI6MSwiY2hhciI6MSwiY2F0Y2giOjEsImV4cG9ydCI6MSx2aXJ0dWFsOjEsb3BlcmF0b3I6MixzaXplb2Y6MixkeW5hbWljX2Nhc3Q6Mix0eXBlZGVmOjIsY29uc3RfY2FzdDoyLCJjb25zdCI6MSxzdHJ1Y3Q6MSwiZm9yIjoxLHN0YXRpY19jYXN0OjIsdW5pb246MSxuYW1lc3BhY2U6MSx1bnNpZ25lZDoxLCJsb25nIjoxLCJ0aHJvdyI6MSwidm9sYXRpbGUiOjIsInN0YXRpYyI6MSwicHJvdGVjdGVkIjoxLGJvb2w6MSx0ZW1wbGF0ZToxLG11dGFibGU6MSwiaWYiOjEsInB1YmxpYyI6MSxmcmllbmQ6MiwiZG8iOjEsInJldHVybiI6MSwiZ290byI6MSxhdXRvOjEsInZvaWQiOjIsImVudW0iOjEsImVsc2UiOjEsImJyZWFrIjoxLCJuZXciOjEsZXh0ZXJuOjEsdXNpbmc6MSwidHJ1ZSI6MSwiY2xhc3MiOjEsYXNtOjEsImNhc2UiOjEsdHlwZWlkOjEsInNob3J0IjoxLHJlaW50ZXJwcmV0X2Nhc3Q6MiwiZGVmYXVsdCI6MSwiZG91YmxlIjoxLHJlZ2lzdGVyOjEsZXhwbGljaXQ6MSxzaWduZWQ6MSx0eXBlbmFtZToxLCJ0cnkiOjEsInRoaXMiOjEsInN3aXRjaCI6MSwiY29udGludWUiOjEsd2NoYXJfdDoxLGlubGluZToxLCJkZWxldGUiOjEsYWxpZ25vZjoxLGNoYXIxNl90OjEsY2hhcjMyX3Q6MSxjb25zdGV4cHI6MSxkZWNsdHlwZToxLG5vZXhjZXB0OjEsbnVsbHB0cjoxLHN0YXRpY19hc3NlcnQ6MSx0aHJlYWRfbG9jYWw6MSxyZXN0cmljdDoxLF9Cb29sOjEsY29tcGxleDoxfSxidWlsdF9pbjp7c3RkOjEsc3RyaW5nOjEsY2luOjEsY291dDoxLGNlcnI6MSxjbG9nOjEsc3RyaW5nc3RyZWFtOjEsaXN0cmluZ3N0cmVhbToxLG9zdHJpbmdzdHJlYW06MSxhdXRvX3B0cjoxLGRlcXVlOjEsbGlzdDoxLHF1ZXVlOjEsc3RhY2s6MSx2ZWN0b3I6MSxtYXA6MSxzZXQ6MSxiaXRzZXQ6MSxtdWx0aXNldDoxLG11bHRpbWFwOjEsdW5vcmRlcmVkX3NldDoxLHVub3JkZXJlZF9tYXA6MSx1bm9yZGVyZWRfbXVsdGlzZXQ6MSx1bm9yZGVyZWRfbXVsdGltYXA6MSxhcnJheToxLHNoYXJlZF9wdHI6MX19O3JldHVybntkTTp7azphLGk6IjwvIixjOltobGpzLkNMQ00saGxqcy5DQkxDTE0saGxqcy5RU00se2NOOiJzdHJpbmciLGI6IidcXFxcPy4iLGU6IiciLGk6Ii4ifSx7Y046Im51bWJlciIsYjoiXFxiKFxcZCsoXFwuXFxkKik/fFxcLlxcZCspKHV8VXxsfEx8dWx8VUx8ZnxGKSJ9LGhsanMuQ05NLHtjTjoicHJlcHJvY2Vzc29yIixiOiIjIixlOiIkIn0se2NOOiJzdGxfY29udGFpbmVyIixiOiJcXGIoZGVxdWV8bGlzdHxxdWV1ZXxzdGFja3x2ZWN0b3J8bWFwfHNldHxiaXRzZXR8bXVsdGlzZXR8bXVsdGltYXB8dW5vcmRlcmVkX21hcHx1bm9yZGVyZWRfc2V0fHVub3JkZXJlZF9tdWx0aXNldHx1bm9yZGVyZWRfbXVsdGltYXB8YXJyYXkpXFxzKjwiLGU6Ij4iLGs6YSxyOjEwLGM6WyJzZWxmIl19XX19fSgpO2hsanMuTEFOR1VBR0VTLnI9e2RNOntjOltobGpzLkhDTSx7Y046Im51bWJlciIsYjoiXFxiMFt4WF1bMC05YS1mQS1GXStbTGldP1xcYiIsZTpobGpzLklNTUVESUFURV9SRSxyOjB9LHtjTjoibnVtYmVyIixiOiJcXGJcXGQrKD86W2VFXVsrXFwtXT9cXGQqKT9MXFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcYlxcZCtcXC4oPyFcXGQpKD86aVxcYik/IixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJudW1iZXIiLGI6IlxcYlxcZCsoPzpcXC5cXGQqKT8oPzpbZUVdWytcXC1dP1xcZCopP2k/XFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MH0se2NOOiJudW1iZXIiLGI6IlxcLlxcZCsoPzpbZUVdWytcXC1dP1xcZCopP2k/XFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJrZXl3b3JkIixiOiIoPzp0cnlDYXRjaHxsaWJyYXJ5fHNldEdlbmVyaWN8c2V0R3JvdXBHZW5lcmljKVxcYiIsZTpobGpzLklNTUVESUFURV9SRSxyOjEwfSx7Y046ImtleXdvcmQiLGI6IlxcLlxcLlxcLiIsZTpobGpzLklNTUVESUFURV9SRSxyOjEwfSx7Y046ImtleXdvcmQiLGI6IlxcLlxcLlxcZCsoPyFbXFx3Ll0pIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MTB9LHtjTjoia2V5d29yZCIsYjoiXFxiKD86ZnVuY3Rpb24pIixlOmhsanMuSU1NRURJQVRFX1JFLHI6Mn0se2NOOiJrZXl3b3JkIixiOiIoPzppZnxpbnxicmVha3xuZXh0fHJlcGVhdHxlbHNlfGZvcnxyZXR1cm58c3dpdGNofHdoaWxlfHRyeXxzdG9wfHdhcm5pbmd8cmVxdWlyZXxhdHRhY2h8ZGV0YWNofHNvdXJjZXxzZXRNZXRob2R8c2V0Q2xhc3MpXFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJsaXRlcmFsIixiOiIoPzpOQXxOQV9pbnRlZ2VyX3xOQV9yZWFsX3xOQV9jaGFyYWN0ZXJffE5BX2NvbXBsZXhfKVxcYiIsZTpobGpzLklNTUVESUFURV9SRSxyOjEwfSx7Y046ImxpdGVyYWwiLGI6Iig/Ok5VTEx8VFJVRXxGQUxTRXxUfEZ8SW5mfE5hTilcXGIiLGU6aGxqcy5JTU1FRElBVEVfUkUscjoxfSx7Y046ImlkZW50aWZpZXIiLGI6IlthLXpBLVouXVthLXpBLVowLTkuX10qXFxiIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MH0se2NOOiJvcGVyYXRvciIsYjoiPFxcLSg/IVxccypcXGQpIixlOmhsanMuSU1NRURJQVRFX1JFLHI6Mn0se2NOOiJvcGVyYXRvciIsYjoiXFwtPnw8XFwtIixlOmhsanMuSU1NRURJQVRFX1JFLHI6MX0se2NOOiJvcGVyYXRvciIsYjoiJSV8fiIsZTpobGpzLklNTUVESUFURV9SRX0se2NOOiJvcGVyYXRvciIsYjoiPj18PD18PT18IT18XFx8XFx8fCYmfD18XFwrfFxcLXxcXCp8L3xcXF58Pnw8fCF8JnxcXHx8XFwkfDoiLGU6aGxqcy5JTU1FRElBVEVfUkUscjowfSx7Y046Im9wZXJhdG9yIixiOiIlIixlOiIlIixpOiJcXG4iLHI6MX0se2NOOiJpZGVudGlmaWVyIixiOiJgIixlOiJgIixyOjB9LHtjTjoic3RyaW5nIixiOiciJyxlOiciJyxjOltobGpzLkJFXSxyOjB9LHtjTjoic3RyaW5nIixiOiInIixlOiInIixjOltobGpzLkJFXSxyOjB9LHtjTjoicGFyZW4iLGI6IltbKHtcXF0pfV0iLGU6aGxqcy5JTU1FRElBVEVfUkUscjowfV19fTsKaGxqcy5pbml0SGlnaGxpZ2h0aW5nT25Mb2FkKCk7Cgo="></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>


<link href="data:text/css;charset=utf-8,body%2C%20td%20%7B%0Afont%2Dfamily%3A%20sans%2Dserif%3B%0Abackground%2Dcolor%3A%20white%3B%0Afont%2Dsize%3A%2013px%3B%0A%7D%0Abody%20%7B%0Amax%2Dwidth%3A%20800px%3B%0Amargin%3A%200%20auto%3B%0Apadding%3A%201em%201em%202em%3B%0Aline%2Dheight%3A%2020px%3B%0A%7D%0A%0Adiv%23TOC%20li%20%7B%0Alist%2Dstyle%3Anone%3B%0Abackground%2Dimage%3Anone%3B%0Abackground%2Drepeat%3Anone%3B%0Abackground%2Dposition%3A0%3B%0A%7D%0A%0Ap%2C%20pre%20%7B%20margin%3A%200em%200em%201em%3B%0A%7D%0A%0Aimg%2C%20table%20%7B%0Amargin%3A%200em%20auto%201em%3B%0A%7D%0Ap%20%7B%0Atext%2Dalign%3A%20justify%3B%0A%7D%0Att%2C%20code%2C%20pre%20%7B%0Afont%2Dfamily%3A%20%27DejaVu%20Sans%20Mono%27%2C%20%27Droid%20Sans%20Mono%27%2C%20%27Lucida%20Console%27%2C%20Consolas%2C%20Monaco%2C%20monospace%3B%0A%7D%0Ah1%2C%20h2%2C%20h3%2C%20h4%2C%20h5%2C%20h6%20%7B%20font%2Dfamily%3A%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Amargin%3A%201%2E2em%200em%200%2E6em%200em%3B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Ah1%2Etitle%20%7B%0Afont%2Dsize%3A%20250%25%3B%0Afont%2Dweight%3A%20normal%3B%0Acolor%3A%20%2387b13f%3B%0Aline%2Dheight%3A%201%2E1em%3B%0Amargin%2Dtop%3A%200px%3B%0Aborder%2Dbottom%3A%200px%3B%0A%7D%0Ah1%20%7B%0Afont%2Dsize%3A%20160%25%3B%0Afont%2Dweight%3A%20normal%3B%0Aline%2Dheight%3A%201%2E4em%3B%0Aborder%2Dbottom%3A%201px%20%231a81c2%20solid%3B%0A%7D%0Ah2%20%7B%0Afont%2Dsize%3A%20130%25%3B%20%7D%0Ah1%2C%20h2%2C%20h3%20%7B%0Acolor%3A%20%231a81c2%3B%0A%7D%0Ah3%2C%20h4%2C%20h5%2C%20h6%20%7B%0Afont%2Dsize%3A115%25%3B%0A%7D%20%0A%0Aa%20%7B%20color%3A%20%231a81c2%3B%20%7D%0Aa%3Aactive%20%7B%20outline%3A%20none%3B%20%7D%0Aa%3Avisited%20%7B%20color%3A%20%231a81c2%3B%20%7D%0Aa%3Ahover%20%7B%20color%3A%20%234c94c2%3B%20%7D%0Apre%2C%20img%20%7B%0Amax%2Dwidth%3A%20100%25%3B%0Adisplay%3A%20block%3B%0A%7D%0Apre%20%7B%0Aborder%3A%200px%20none%3B%0Abackground%2Dcolor%3A%20%23F8F8F8%3B%0Awhite%2Dspace%3A%20pre%3B%0Aoverflow%2Dx%3A%20auto%3B%0A%7D%0Apre%20code%20%7B%0Aborder%3A%201px%20%23aaa%20dashed%3B%0Abackground%2Dcolor%3A%20white%3B%0Adisplay%3A%20block%3B%0Apadding%3A%201em%3B%20color%3A%20%23111%3B%0Aoverflow%2Dx%3A%20inherit%3B%0A%7D%0A%0Apre%20code%5Bclass%5D%20%7B%0Abackground%2Dcolor%3A%20inherit%3B%0A%7D%0A%0Apre%5Bclass%5D%20code%20%7B%0Abackground%2Dcolor%3A%20inherit%3B%0A%7D%0A%0Acode%20%7B%20background%2Dcolor%3A%20transparent%3B%0Acolor%3A%20%2387b13f%3B%0Afont%2Dsize%3A%2092%25%3B%0A%7D%0A%0Atable%2C%20td%2C%20th%20%7B%0Aborder%3A%20none%3B%0Apadding%3A%200%200%2E5em%3B%0A%7D%0A%0Atbody%20tr%3Anth%2Dchild%28odd%29%20td%20%7B%0Abackground%2Dcolor%3A%20%23F8F8F8%3B%0A%7D%0Ablockquote%20%7B%0Acolor%3A%23666666%3B%0Amargin%3A0%3B%0Apadding%2Dleft%3A%201em%3B%0Aborder%2Dleft%3A%200%2E5em%20%23EEE%20solid%3B%0A%7D%0Ahr%20%7B%0Aheight%3A%200px%3B%0Aborder%2Dbottom%3A%20none%3B%0Aborder%2Dtop%2Dwidth%3A%20thin%3B%0Aborder%2Dtop%2Dstyle%3A%20dotted%3B%0Aborder%2Dtop%2Dcolor%3A%20%23999999%3B%0A%7D%0Aspan%2Eheader%2Dsection%2Dnumber%20%7B%0Apadding%2Dright%3A%201em%3B%0A%7D%0Aspan%2Etoc%2Dsection%2Dnumber%3A%3Aafter%20%7B%0Acontent%3A%20%22%20%22%3B%0Awhite%2Dspace%3A%20pre%3B%0A%7D%0A%40media%20print%20%7B%0A%2A%20%7B%0Abackground%3A%20transparent%20%21important%3B%0Acolor%3A%20black%20%21important%3B%0Afilter%3Anone%20%21important%3B%0A%2Dms%2Dfilter%3A%20none%20%21important%3B%0A%7D%0Abody%20%7B%0Afont%2Dsize%3A12pt%3B%0Amax%2Dwidth%3A100%25%3B%0A%7D%0Aa%2C%20a%3Avisited%20%7B%0Atext%2Ddecoration%3A%20underline%3B%0A%7D%0Ahr%20%7B%0Avisibility%3A%20hidden%3B%0Apage%2Dbreak%2Dbefore%3A%20always%3B%0A%7D%0Apre%2C%20blockquote%20%7B%0Apadding%2Dright%3A%201em%3B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Atr%2C%20img%20%7B%0Apage%2Dbreak%2Dinside%3A%20avoid%3B%0A%7D%0Aimg%20%7B%0Amax%2Dwidth%3A%20100%25%20%21important%3B%0A%7D%0A%40page%20%3Aleft%20%7B%0Amargin%3A%2015mm%2020mm%2015mm%2010mm%3B%0A%7D%0A%40page%20%3Aright%20%7B%0Amargin%3A%2015mm%2010mm%2015mm%2020mm%3B%0A%7D%0Ap%2C%20h2%2C%20h3%20%7B%0Aorphans%3A%203%3B%20widows%3A%203%3B%0A%7D%0Ah2%2C%20h3%20%7B%0Apage%2Dbreak%2Dafter%3A%20avoid%3B%0A%7D%0A%7D%0A" rel="stylesheet" type="text/css" />

<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if(links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script>

</head>

<body>


<div id="header">
<h1 class="title"><em>eiR</em>: Accelerated Similarity Searching of Small Molecules</h1>
<h4 class="author"><em>Authors: Kevin Horan, Yiqun Cao, Tyler Backman &amp; <a href="thomas.girke@ucr.edu">Thomas Girke</a></em></h4>
<h4 class="date"><em>Last update: 04 January, 2016</em></h4>
</div>
<h4 class="package">Package version: <span style="font-weight: normal">eiR 1.10.0</span></h4>

<h1>Contents</h1>
<div id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#initialization"><span class="toc-section-number">2</span> Initialization</a></li>
<li><a href="#creating-a-searchable-database"><span class="toc-section-number">3</span> Creating a Searchable Database</a></li>
<li><a href="#queries"><span class="toc-section-number">4</span> Queries</a></li>
<li><a href="#adding-new-compounds"><span class="toc-section-number">5</span> Adding New Compounds</a></li>
<li><a href="#performance-tests"><span class="toc-section-number">6</span> Performance Tests</a></li>
<li><a href="#clustering"><span class="toc-section-number">7</span> Clustering</a></li>
<li><a href="#customization"><span class="toc-section-number">8</span> Customization</a></li>
<li><a href="#version-information"><span class="toc-section-number">9</span> Version Information</a></li>
<li><a href="#funding"><span class="toc-section-number">10</span> Funding</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<!--
%% \VignetteEngine{knitr::rmarkdown}
%% \VignetteEncoding{UTF-8}
%\VignetteIndexEntry{eiR}
%% \VignetteKeywords{cheminformatics, structural searching, clustering}
%% \VignettePackage{eiR}
-->
<!---
- Compile from command-line
echo "rmarkdown::render('eiR.Rmd')" | R -slave; R CMD Stangle eiR.Rmd

- Commit to github
git commit -am "some edits"; git push -u origin master

- To customize font size and other style features, add this line to output section in preamble:  
    css: style.css
-->
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script>
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script>
<p>Note: the most recent version of this tutorial can be found <a href="https://htmlpreview.github.io/?https://github.com/girke-lab/eiR/blob/master/vignettes/eiR.html">here</a> and a short overview slide show <a href="http://faculty.ucr.edu/~tgirke/HTML_Presentations/Manuals/Workshop_Dec_5_8_2014/Rcheminfo/Cheminfo.pdf">here</a>.</p>
<div id="introduction" class="section level1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>The R package <code>eiR</code> provides an index for chemical compound databases allowing one to quickly find similar compounds in a very large database. To create this index, <em>r</em> reference compounds are selected to represent the database. Then each compound in the database is embedded into <em>d</em>-dimensional space based on their distance to each reference compound. This requires time linear in the size of the database, but only needs to be done once for a database. Within this space, Locality Sensitive Hashing (LSH) is employed to allow sub-linear time nearest neighbor lookups <span class="citation">(Dong, Wang, Charikar, et al. 2008; Dong, Wang, Josephson, et al. 2008)</span> that nearest neighbors can be found without doing a linear scan through the entire compound database. Additional compounds can be added to the database in time linear to the number of new compounds. No time is spend processing existing compounds, as long as the set of reference compounds remains the same. Given the ability to quickly find nearest neighbors, this method enables fast clustering with the Jarvis-Pattrick algorithm as well <span class="citation">(Jarvis and Patrick 1973)</span>. For details on the whole process see <span class="citation">(Cao, Jiang, and Girke 2010)</span>.</p>
<p>This library uses an SQL back-end (SQLite by default) to store chemical compound definitions, either in SDF or SMILE format, as well as descriptors. Several different kinds of descriptors can be stored for each compound, for example, one could compute and store atom-pair and fingerprint descriptors for each compound. The SQLite database, if used, is stored in a directory called <code>data</code>. The <code>eiInit</code> function is used to create a new database, it can import data from SDF or SMILE formated files, or an <code>SDFset</code> object.</p>
<p>Once a database has been created, an embedding must also be created <span class="citation">(Dimitris K. Agrafiotis, Dmitrii N. Rassokhin, Victor S. Lobanov 2001)</span>. In this step the reference compounds are chosen and each compound is embedded into the new space. This step creates a new directory called <code>run-r-d</code>, where <code>r</code> and <code>d</code> are the corresponding values. This is the most costly step of the process and is handled by the <code>eiMakeDb</code> function. This step can be parallelized by providing a SNOW cluster to the eiMakeDb function.</p>
<p>Given an embedded database, queries can be run against it with the <code>eiQuery</code> function. Additional compounds can also be added to an existing database and embedding using <code>eiAdd</code>. Performance tests can be run using the eiPerformanceTest function, and Jarvis-Patrick clustering can be done with the <code>eiCluster</code> function.</p>
<p><code>eiR</code> also provides some mechanisms to allow the user to extend the set of descriptor formats used and to define new distance functions. See Section <a href="#customization">Customization</a> for details.</p>
</div>
<div id="initialization" class="section level1">
<h1><span class="header-section-number">2</span> Initialization</h1>
<p>An initial compound database must be created with the following command:</p>
<pre class="r"><code>library(eiR) 
data(sdfsample) 
eiInit(sdfsample[1:99]) </code></pre>
<pre><code>## Loading required package: RSQLite</code></pre>
<pre><code>## [1] &quot;createing db&quot;</code></pre>
<pre><code>## loaded 99 compounds</code></pre>
<pre><code>## [1] &quot;99  loaded by eiInit&quot;</code></pre>
<pre><code>## setting priorities for 4 groups.
## Note: the specification for class &quot;RSWIGStruct&quot; in package 'ChemmineOB' seems equivalent to one from package 'ChemmineR': not turning on duplicate class definitions for this class.</code></pre>
<pre><code>##  [1] 297 260 252 201 231 270 214 233 209 278 226 287 205 277 224 237 254 203 222 273 217 239 269 225
## [25] 258 235 266 208 211 206 299 263 281 280 291 243 249 248 212 234 241 245 279 261 216 293 207 230
## [49] 295 232 272 219 223 255 256 210 262 218 286 228 276 268 289 202 265 246 213 288 296 285 229 294
## [73] 221 275 236 253 282 244 242 259 284 264 238 274 250 271 215 204 267 240 292 298 257 283 220 227
## [97] 247 290 251</code></pre>
<p>EiInit can take either an SDFset, or a filename. If a filename is given it must be in either SDF or SMILE format and the format must be specified with the <code>format</code> paramter. It might complain if your SDF file does not follow the SDF specification. If this happens, you can create an SDFset with the <code>read.SDFset</code> command and then use that instead of the filename.</p>
<p>Descriptors will also be computed at this time. The default descriptor type is atompair. Other types can be used by setting the <code>descriptorType</code> parameter. Currently available types are “ap” for atompair, and “fp” for fingerprint. The set of available descriptors can be extended, see Section <a href="#customization">Customization</a>. EiInit will create a folder called ‘data’. Commands should always be executed in the folder containing this directory (ie, the parent directory of “data”), or else specify the location of that directory with the <code>dir</code> option.</p>
<p><code>EiInit</code> also has some options to support loading data in parallel. This is only possible if the SQL database being used supports parallel writes. For now, this means only PostgreSQL. To use this feature, the <code>inputs</code> parameter must be set to an array of filenames, <code>cl</code> set to a SNOW cluster, and <code>connSource</code> set to a function which will return a new database connection when called with no parameters. Then each file will be loaded on a different node of the given cluster, in parallel. The <code>connSource</code> function must actually create a new connection on each call, simply returning the same reference to an existing connection will not work. This is because that function will be called on potentially different machines which will have to establish their own connection to the database.</p>
<p>Compounds which already exist in the database will be skipped over, so it is safe to re-run <code>eiInit</code> on an input file which has already been partially loaded. By default it discovers duplicates by comparing the entire compound definition. However, if you want two compounds with the same name to be considered equal even if the definition is different, you can set <code>updateByName</code> to be true. In this mode, if a compound being loaded is found to exist in the database already, by name, but has a different definition, the compound will be updated with the new definition and any associated descriptors and/or features will be re-computed.</p>
<p>eiInit will return a list of compound id numbers which represent the compounds just inserted. These numbers can be used to issue queries later.</p>
</div>
<div id="creating-a-searchable-database" class="section level1">
<h1><span class="header-section-number">3</span> Creating a Searchable Database</h1>
<p>In this step the compounds in the data directory will be embedded in another space which allows for more efficient searching. The main two parameters are <code>refs</code> and <code>d</code>. <code>refs</code> can be either a list of compound ids to use as references, or else an integer value indicating the number of references to use, which will then be randomly chosen. We will use <em>r</em> to represent the number of reference compounds. <em>d</em> is the dimension of the embedding space. We have found in practice that setting <em>d</em> to around 100 works well. <em>r</em> should be large enough to “represent” the full compound database. Since creating a database is the longest running step, a SNOW cluster can be provided to parallelize the task. A <code>conSource</code> function is also required in this case, as described in Section <a href="#initialization">Initialization</a>.</p>
<p>To help tune these values, <code>eiMakeDb</code> will pick <code>numSamples</code> non-reference samples which can later be used by the <a href="#performance-tests"><code>eiPerformanceTest</code></a> function.</p>
<p><code>eiMakdDb</code> does its job in a job folder, named after the number of reference compounds and the number of embedding dimensions. For example, using 300 reference compounds to generate a 100-dimensional embedding (<code>r=300,</code>d<code>=100</code>) will result in a job folder called <code>run-300-100</code>. The embedding result is the file matrix.r.d. In the above example, the output would be <code>run-300-100/matrix.300.100</code>.</p>
<p>Since more than one type of descriptor can be stored for each compound, the desired descriptor type must be given to this function with the <code>descriptorType</code> parameter. The default value is “ap”, for atompair. You can also specify a custom distance function that must be able to take two descriptors in the format specified and return a distance value. The default distance method used is 1-Tanimoto(descriptor1,descriptor2).</p>
<p>The return value is called the Run Id. This value is needed by other functions to identify the data set and embedding parameters to use.</p>
<pre class="r"><code>r&lt;- 60 
d&lt;- 40 
runId &lt;- eiMakeDb(r,d) </code></pre>
<pre><code>## found 95 un-embedded descriptors for runId 1
## Regenerating matrix file...
## Regenerating matrix file...</code></pre>
</div>
<div id="queries" class="section level1">
<h1><span class="header-section-number">4</span> Queries</h1>
<p>Queries can be given in several formats, defined by the <code>format</code> parameter. The default format is “sdf”. The <code>queries</code> parameter can be either an SDF file or an SDFset under this format. Other valid values for <code>format</code> are “name” and “compound_id”. Under these two formats the <code>queries</code> parameter is expected to be a list of compound names (as returned by sdfid on an SDFset), or a list of compound id numbers from the database, such as what is returned by the eiInit function.</p>
<p>The <code>runId</code> parameter is required to determine which embedded database to use. As with <code>eiMakeDb</code>, the <code>distance</code> parameter may be given if desired, it will default to the Tanimoto Coefficient otherwise. Finally, the parameter <code>K</code> is the number of results that will be returned. In some cases, particularly if <code>K</code> is small, you may need to set it to a larger value and then trim down the result set yourself. This is because LSH is not an exact algorithm. Internally, it actually searches for <code>xK</code> neighbors, where <code>x</code> is referred to as the expansion ratio, generally set to 2. This allows it to pick the best <code>K</code> matches, according to the true distance function, out of a larger set of candidates. When <code>K</code> is small though, sometimes that expansion ratio is not quite enough.</p>
<p>Note also that this function returns distance values and not similarities. Similarities can be computed by setting <code>asSimilarity</code> to TRUE. This assumes that whatever distance function is currently in use returns values between 0 and 1. This is true for the default distance functions for “ap” and “fp” descriptors.</p>
<p>Then you can perform a query as follows:</p>
<pre class="r"><code>#find compounds similar to each query
result=eiQuery(runId,sdfsample[45],K=10,asSimilarity=TRUE)
print(result)</code></pre>
<pre><code>##     query target similarity target_ids
## 1  650046 650046  1.0000000        245
## 2  650046 650054  0.5133418        251
## 3  650046 650011  0.4651163        211
## 4  650046 650092  0.3922652        286
## 5  650046 650069  0.3897316        264
## 6  650046 650048  0.3825758        247
## 7  650046 650008  0.3256659        208
## 8  650046 650072  0.3051251        267
## 9  650046 650100  0.3027888        294
## 10 650046 650085  0.2651685        279</code></pre>
<pre class="r"><code>#Compare to traditional similarity search: 
data(apset)
print(cmp.search(apset,apset[45],type=3,cutoff=4,quiet=TRUE))</code></pre>
<pre><code>##   index    cid    scores
## 1    45 650046 1.0000000
## 2    51 650054 0.5133418
## 3    11 650011 0.4651163
## 4    86 650092 0.3922652</code></pre>
<pre class="r"><code>cid(sdfsample)=sdfid(sdfsample)
plot(sdfsample[result$target[1:4]],regenCoords=TRUE,print=FALSE)</code></pre>
<div class="figure">
<img src="data:image/png;base64,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" alt />

</div>
<p>The result will be a data frame with four columns. The first is a query id, the second is a target, or hit, id, the third is the distance (or similarity if <code>asSimilary</code> was true) between the query and the target, and the fourth column is the compound id number of the target. Lsh parameters can be passed in as well, see Section <a href="#performance-tests">Performance Tests</a> for more details.</p>
</div>
<div id="adding-new-compounds" class="section level1">
<h1><span class="header-section-number">5</span> Adding New Compounds</h1>
<p>New Compounds can be added to an existing database, however, the reference compounds cannot be changed. To add new compounds, use the eiAdd function. This function is very similar to the eiQuery function, except instead of a <code>queries</code> parameter, there is an <code>additions</code> parameter, defining the compounds to be added. The format of the value of this parameter works the same as in the eiQuery function. For example, to add one compound from an SDFset you would do:</p>
<pre class="r"><code> eiAdd(runId,sdfsample[100]) </code></pre>
<pre><code>## loaded 1 compounds</code></pre>
<pre><code>## [1] &quot;1  loaded by eiInit&quot;</code></pre>
<pre><code>## setting priorities for 0 groups.
## found 1 un-embedded descriptors for runId 1
## Regenerating matrix file...</code></pre>
<pre><code>## [1] 300</code></pre>
<p>The returned value is a list of the compounds ids that were just added. This function will also write out a new matrix file in the run directory. For large databases, this can take a significant amount of time.</p>
</div>
<div id="performance-tests" class="section level1">
<h1><span class="header-section-number">6</span> Performance Tests</h1>
<p>The eiPerforamceTest function will run several tests using some sample data to evaluate the performance of the current embedding. It takes the usual <code>runId</code> parameter, as well as on optional distance function. It also takes several LSH parameters, though the defaults are usually fine. To evaluate the performance you can run:</p>
<pre class="r"><code> eiPerformanceTest(runId,K=22) </code></pre>
<p>This will perform two different tests. The first tests the embedding results in similarity search. The way this works is by approximating 1,000 random similarity searches (determined by data/test_queries.iddb) by nearest neighbor search using the coordinates from the embedding results. The search results are then compared to the reference search results (chemical-search.results.gz).</p>
<p>The comparison results are summarized in two types of files. The first type lists the recall for different k values, k being the number of numbers to retrieve. These files are named as “recall-ratio-k”. For example, if the recall is 70% for top-100 compound search (70 of the 100 results are among the real top-100 compounds) then the value at line 100 is 0.7. Several relaxation ratios are used, each generating a file in this form. For instance, recall.ratio-10 is the file listing the recalls when relaxation ratio is 10. The other file, recall.csv, lists recalls of different relaxation ratios in one file by limiting to selected k value. In this CSV file, the rows correspond to different relaxation ratios, and the columns are different k values. You will be able to pick an appropriate relaxation ratio for the k values you are interested in.</p>
<p>The second test measures the performance of the Locality Sensitive Hash (LSH). The results for lsh-assisted search will be in run-r-d/indexed.performance. It’s a 1,000-line file of recall values. Each line corresponds to one test query. LSH search performance is highly sensitive to your LSH parameters (K, W, M, L, T). The default parameters are listed in the man page for <code>eiPerformanceTest</code>. When you have your embedding result in a matrix file, you should follow instruction on <a href="http://lshkit.sourceforge.net/dd/d2a/mplsh-tune_8cpp.html" class="uri">http://lshkit.sourceforge.net/dd/d2a/mplsh-tune_8cpp.html</a> to find the best values for these parameters.</p>
</div>
<div id="clustering" class="section level1">
<h1><span class="header-section-number">7</span> Clustering</h1>
<p>Compounds can be clustered in near linear time using the Jarvis-Patrick clustering algorithm by taking advantage of the near constant time nearest neighbor lookup provided by the LSH index. Clustering is done with the <code>eiCluster</code> function. It takes a <code>runId</code> to identify the data set and embedding, and two parameters for the Jarvis-Patrick algorithm: <code>K</code> is the number of neighbors to fetch for each compound, and <code>minNbrs</code> is the minimum number of neighbors two compounds must have in common in order to be joined into the same cluster. A <code>cutoff</code> value can also be given to set a maximum distance between neighbors. Any two compounds farther apart than this cutoff will never be considered neighbors. This parameter is helpful in preventing compounds which are very different from almost every other compound from being considered similar to other distant compounds simply because they happened to be closest.</p>
<p>By default <code>eiCluster</code> will cluster the entire dataset specified by <code>runId</code>. If you want to only cluster a subset of those compounds, you can provide their compound id values to the <code>compoundIds</code> parameter.</p>
<pre class="r"><code>    clustering &lt;- eiCluster(runId,K=5,minNbrs=2,cutoff=0.5)</code></pre>
<pre><code>## numQueries: 96, querySize: 40</code></pre>
<pre class="r"><code>    byCluster(clustering)</code></pre>
<pre><code>## $`211`
## [1] &quot;211&quot; &quot;286&quot;
## 
## $`215`
## [1] &quot;215&quot; &quot;264&quot;
## 
## $`248`
## [1] &quot;248&quot; &quot;249&quot;
## 
## $`269`
## [1] &quot;269&quot; &quot;279&quot;</code></pre>
</div>
<div id="customization" class="section level1">
<h1><span class="header-section-number">8</span> Customization</h1>
<p><code>eiR</code> can be extended to understand new descriptor types and new distance functions. New distance functions can be set in two different ways. Any function that takes a distance parameter can be given a new distance function that will be used for just that call. If no distance function is given, it will fetch a default distance function that has been defined for the given descriptor type. This default value can be changed using the <code>setDefaultDistance</code> function, which takes the descriptor type and a distance function. Once this function has been called, the new distance function will be used for that descriptor type by all functions using a distance function. The built-in defaults are defined as follows:</p>
<pre class="r"><code>setDefaultDistance(&quot;ap&quot;, function(d1,d2) 1-cmp.similarity(d1,d2) ) 
setDefaultDistance(&quot;fp&quot;, function(d1,d2) 1-fpSim(d1,d2) ) </code></pre>
<p>New descriptor types can also be added using the <code>addTransform</code> function. These transforms are basically just ways to read descriptors from compound definitions, and to convert descriptors between string and object form. This conversion is required because descriptors are stored as strings in the SQL database, but are used by the rest of the program as objects.</p>
<p>There are two main components that need to be added. The <code>addTransform</code> function takes the name of the transform and two functions, <code>toString</code>, and <code>toObject</code>. These have slightly different meanings depending on the component you are adding. The first component to add is a transform from a chemical compound format, such as SDF, to a descriptor format, such as atom pair (AP), in either string or object form. The toString function should take any kind of chemical compound source, such an SDF file, an SDF object or an SDFset, and output a string representation of the descriptors. Since this function can be written in terms of other functions that will be defined, you can usually accept the default value of this function. The toObject function should take the same kind of input, but output the descriptors as an object. The actual return value is a list containing the names of the compounds (in the names field), and the actual descriptor objects ( in the descriptors field).</p>
<p>The second component to add is a transform that converts between string and object representations of descriptors. In this case the toString function takes descriptors in object form and returns a string representation for each. The toObject function performs the inverse operation. It takes descriptors in string form and returns them as objects. The objects returned by this function will be exactly what is handed to the distance function, so you need to make sure that the two match each other.</p>
<p>For example, to allow atom pair descriptors to be extracted from and SDF source we would make the following call:</p>
<pre class="r"><code>addTransform(&quot;ap&quot;,&quot;sdf&quot;,
    toObject = function(input,conn=NULL,dir=&quot;.&quot;){
        sdfset=if(is.character(input) &amp;&amp; file.exists(input)){
            read.SDFset(input)
        }else if(inherits(input,&quot;SDFset&quot;)){
            input
        }else{
            stop(paste(&quot;unknown type for 'input', 
                or filename does not exist. type found:&quot;,class(input)))
        }
        list(names=sdfid(sdfset),descriptors=sdf2ap(sdfset))
    }
)

addTransform(&quot;ap&quot;,  
    toString = function(apset,conn=NULL,dir=&quot;.&quot;){
        unlist(lapply(ap(apset), function(x) paste(x,collapse=&quot;, &quot;)))
    },
    toObject= function(v,conn=NULL,dir=&quot;.&quot;){ 
        if(inherits(v,&quot;list&quot;) || length(v)==0)
            return(v)

        as( if(!inherits(v,&quot;APset&quot;)){
                names(v)=as.character(1:length(v));  
                read.AP(v,type=&quot;ap&quot;,isFile=FALSE)
            } else v,
            &quot;list&quot;)  
    }
)</code></pre>
</div>
<div id="version-information" class="section level1">
<h1><span class="header-section-number">9</span> Version Information</h1>
<pre class="r"><code>sessionInfo()</code></pre>
<p>R version 3.2.3 (2015-12-10) Platform: x86_64-pc-linux-gnu (64-bit) Running under: Ubuntu 14.04.3 LTS</p>
<p>locale: [1] LC_CTYPE=en_US.UTF-8 LC_NUMERIC=C LC_TIME=en_US.UTF-8<br />
 [4] LC_COLLATE=en_US.UTF-8 LC_MONETARY=en_US.UTF-8 LC_MESSAGES=en_US.UTF-8<br />
 [7] LC_PAPER=en_US.UTF-8 LC_NAME=C LC_ADDRESS=C<br />
[10] LC_TELEPHONE=C LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C</p>
<p>attached base packages: [1] stats graphics utils datasets grDevices methods base</p>
<p>other attached packages: [1] ChemmineOB_1.8.0 RSQLite_1.0.0 eiR_1.10.0 DBI_0.3.1 ChemmineR_2.23.1 [6] BiocStyle_1.8.0</p>
<p>loaded via a namespace (and not attached): [1] Rcpp_0.12.2 knitr_1.11 magrittr_1.5 zlibbioc_1.16.0 MASS_7.3-45<br />
 [6] munsell_0.4.2 colorspace_1.2-6 rjson_0.2.15 stringr_1.0.0 plyr_1.8.3<br />
[11] tools_3.2.3 snowfall_1.84-6.1 grid_3.2.3 gtable_0.1.2 snow_0.4-1<br />
[16] htmltools_0.2.6 yaml_2.1.13 digest_0.6.8 reshape2_1.4.1 ggplot2_1.0.1<br />
[21] formatR_1.2.1 codetools_0.2-14 bitops_1.0-6 RCurl_1.95-4.7 evaluate_0.8<br />
[26] rmarkdown_0.8.1 stringi_1.0-1 scales_0.3.0 proto_0.3-10</p>
</div>
<div id="funding" class="section level1">
<h1><span class="header-section-number">10</span> Funding</h1>
<p>This software was developed with funding from the National Science Foundation: <a href="http://www.nsf.gov/awardsearch/showAward.do?AwardNumber=0957099">ABI-0957099</a>, 2010-0520325 and IGERT-0504249.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-Cao2010-ir">
<p>Cao, Y, T Jiang, and T Girke. 2010. “Accelerated Similarity Searching and Clustering of Large Compound Sets by Geometric Embedding and Locality Sensitive Hashing.” <em>Bioinformatics</em> 26 (7): 953–59. doi:<a href="http://doi.org/10.1093/bioinformatics/btq067">10.1093/bioinformatics/btq067</a>.</p>
</div>
<div id="ref-Dimitris_K_Agrafiotis_Dmitrii_N_Rassokhin_Victor_S_Lobanov2001-eq">
<p>Dimitris K. Agrafiotis, Dmitrii N. Rassokhin, Victor S. Lobanov. 2001. “Multidimensional Scaling and Visualization of Large Molecular Similarity Tables.” In <em>Journal of Computational Chemistry</em>. <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.84.2995" class="uri">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.84.2995</a>.</p>
</div>
<div id="ref-Dong2008-ib">
<p>Dong, Wei, Zhe Wang, Moses Charikar, and Kai Li. 2008. “Efficiently Matching Sets of Features with Random Histograms.” In <em>Proceedings of the 16th ACM International Conference on Multimedia</em>, 179–88. MM ’08. New York, NY, USA: ACM. doi:<a href="http://doi.org/10.1145/1459359.1459384">10.1145/1459359.1459384</a>.</p>
</div>
<div id="ref-Dong2008-kn">
<p>Dong, Wei, Zhe Wang, William Josephson, Moses Charikar, and Kai Li. 2008. “Modeling LSH for Performance Tuning.” In <em>Proceedings of the 17th ACM Conference on Information and Knowledge Management</em>, 669–78. ACM. doi:<a href="http://doi.org/10.1145/1458082.1458172">10.1145/1458082.1458172</a>.</p>
</div>
<div id="ref-Jarvis1973-lp">
<p>Jarvis, RA, and EA Patrick. 1973. “Clustering Using a Similarity Measure Based on Shared Near Neighbors.” <em>IEEE Trans. Comput.</em> 22 (11). IEEE Computer Society Washington, DC, USA: 1025–34.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
